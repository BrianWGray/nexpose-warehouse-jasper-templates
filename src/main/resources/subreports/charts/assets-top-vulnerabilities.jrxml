<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.3.1.final using JasperReports Library version 6.3.1  -->
<!-- 2016-10-12T10:58:31 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="assets-top-risk" pageWidth="523" pageHeight="842" columnWidth="523" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="463badc9-3049-4eb7-aa2f-b751f96f3dd9">
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="warehouse"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<parameter name="COUNT" class="java.lang.Integer">
		<parameterDescription><![CDATA[The number of assets to include in the prioritization.]]></parameterDescription>
		<defaultValueExpression><![CDATA[10]]></defaultValueExpression>
	</parameter>
	<parameter name="BASE_DIR" class="java.lang.String" isForPrompting="false">
		<parameterDescription><![CDATA[]]></parameterDescription>
		<defaultValueExpression><![CDATA["../.."]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT da.asset_id AS id, COALESCE(da.host_name, HOST(da.ip_address)) AS dim_asset_name, fa.risk_score AS riskscore,
   fa.vulnerabilities AS total_vuln, fa.malware_kits AS fa_malware_count, fa.exploits AS fa_exploit_count
FROM fact_asset fa
   JOIN dim_asset da USING (asset_id)
WHERE fa.risk_score > 0
ORDER BY fa.risk_score DESC
LIMIT $P{COUNT}]]>
	</queryString>
	<field name="id" class="java.lang.Long"/>
	<field name="dim_asset_name" class="java.lang.String"/>
	<field name="riskscore" class="java.lang.Double"/>
	<field name="total_vuln" class="java.lang.Long"/>
	<field name="fa_malware_count" class="java.lang.Integer"/>
	<field name="fa_exploit_count" class="java.lang.Integer"/>
	<summary>
		<band height="320" splitType="Stretch">
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<multiAxisChart>
				<chart isShowLegend="false" evaluationTime="Report">
					<reportElement positionType="Float" x="0" y="0" width="523" height="320" uuid="ff463ed0-404c-42da-a16c-8044f5123509">
						<property name="MaximumCategoryLabelLines" value="2"/>
						<property name="if (useIntegerTickUnits) {  valueAxis.setStandardTickUnits(NumberAxis.createIntegerTickUnits()); }" value="True"/>
						<property name="setMaximumBarWidth" value="2"/>
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					</reportElement>
					<chartTitle>
						<font size="3"/>
					</chartTitle>
					<chartSubtitle>
						<font size="3"/>
					</chartSubtitle>
					<chartLegend>
						<font size="3"/>
					</chartLegend>
				</chart>
				<multiAxisPlot>
					<plot orientation="Horizontal">
						<seriesColor seriesOrder="0" color="#3972DB"/>
					</plot>
					<axis position="rightOrBottom">
						<barChart>
							<chart isShowLegend="false">
								<reportElement x="0" y="0" width="0" height="0" backcolor="#FFFFFF" uuid="af5c0b2e-acde-4b8c-b792-6aa293e89f9b">
									<property name="setMaximumBarWidth" value=".0001"/>
									<property name="getMaximumBarWidth" value=".05"/>
									<property name="MaximumCategoryLabelLines" value="5"/>
								</reportElement>
								<chartTitle color="#000000">
									<font size="3"/>
								</chartTitle>
								<chartSubtitle color="#000000">
									<font size="3"/>
								</chartSubtitle>
								<chartLegend textColor="#000000" backgroundColor="#FFFFFF">
									<font size="3"/>
								</chartLegend>
							</chart>
							<categoryDataset>
								<categorySeries>
									<seriesExpression><![CDATA[""]]></seriesExpression>
									<categoryExpression><![CDATA["("+ $V{REPORT_COUNT}+ ")" + "  " + ($F{dim_asset_name}.length() > 20 ? $F{dim_asset_name}.substring(0, 19) + "..." : $F{dim_asset_name})]]></categoryExpression>
									<valueExpression><![CDATA[$F{riskscore}]]></valueExpression>
									<labelExpression><![CDATA[$F{dim_asset_name}]]></labelExpression>
								</categorySeries>
							</categoryDataset>
							<barPlot isShowLabels="false">
								<plot orientation="Horizontal" labelRotation="0.0">
									<seriesColor seriesOrder="0" color="#98CD32"/>
								</plot>
								<itemLabel>
									<font size="7"/>
								</itemLabel>
								<categoryAxisFormat labelRotation="0.0">
									<axisFormat verticalTickLabels="false" axisLineColor="#FEFEFE">
										<labelFont>
											<font size="9"/>
										</labelFont>
										<tickLabelFont>
											<font size="9"/>
										</tickLabelFont>
									</axisFormat>
								</categoryAxisFormat>
								<valueAxisLabelExpression><![CDATA["Vulnerabilities"]]></valueAxisLabelExpression>
								<valueAxisFormat>
									<axisFormat verticalTickLabels="false" axisLineColor="#C1C1C1">
										<tickLabelFont>
											<font size="9"/>
										</tickLabelFont>
									</axisFormat>
								</valueAxisFormat>
							</barPlot>
						</barChart>
					</axis>
				</multiAxisPlot>
			</multiAxisChart>
		</band>
	</summary>
</jasperReport>
