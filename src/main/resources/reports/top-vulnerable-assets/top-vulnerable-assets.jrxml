<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.3.1.final using JasperReports Library version 6.3.1  -->
<!-- 2016-10-12T11:01:38 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="top-vulnerable-assets" pageWidth="595" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="523" leftMargin="36" rightMargin="36" topMargin="36" bottomMargin="7" uuid="a786fdfe-ffc6-438b-b7f5-989b07c781b2">
	<property name="ireport.zoom" value="1.0514816984441795"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="288"/>
	<property name="ireport.layers" value="##Fri Aug 31 13:09:25 PDT 2012\nlayer.0.name=Background\nlayer.0.visible=true\nlayer.0.id=0"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="warehouse"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<style name="Title" fontSize="50" isBold="true"/>
	<style name="SubTitle" forecolor="#736343" fontSize="18"/>
	<style name="Column header" forecolor="#666666" fontSize="12" isBold="true"/>
	<style name="Detail" fontSize="12"/>
	<style name="Row" mode="Transparent">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{REPORT_COUNT}%2 == 0]]></conditionExpression>
			<style backcolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<parameter name="REPORT_NAME" class="java.lang.String">
		<parameterDescription><![CDATA[]]></parameterDescription>
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="COUNT" class="java.lang.Integer">
		<parameterDescription><![CDATA[The number of assets to include in the prioritization.]]></parameterDescription>
		<defaultValueExpression><![CDATA[10]]></defaultValueExpression>
	</parameter>
	<parameter name="BASE_DIR" class="java.lang.String" isForPrompting="false">
		<parameterDescription><![CDATA[]]></parameterDescription>
		<defaultValueExpression><![CDATA["../.."]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT asset_id AS id, COALESCE(host_name, HOST(ip_address)) AS dim_asset_name,
   vulnerabilities AS total_vuln, malware_kits AS fa_malware_count, exploits AS fa_exploit_count
FROM fact_asset fa
   JOIN dim_asset da USING (asset_id)
WHERE fa.risk_score > 0
ORDER BY fa.vulnerabilities DESC
LIMIT $P!{COUNT}]]>
	</queryString>
	<field name="id" class="java.lang.Long"/>
	<field name="dim_asset_name" class="java.lang.String"/>
	<field name="total_vuln" class="java.lang.Long"/>
	<field name="fa_malware_count" class="java.lang.Integer"/>
	<field name="fa_exploit_count" class="java.lang.Integer"/>
	<variable name="CURRENT_PAGE_NUMBER" class="java.lang.Integer" resetType="None">
		<variableExpression><![CDATA[$V{PAGE_NUMBER}]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<title>
		<band height="290" splitType="Stretch">
			<subreport>
				<reportElement positionType="Float" x="0" y="0" width="523" height="45" uuid="2ae90c3a-d390-470c-8819-62551a9c98b2">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<subreportParameter name="REPORT_NAME">
					<subreportParameterExpression><![CDATA[$P{REPORT_NAME}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="COUNT">
					<subreportParameterExpression><![CDATA[$P{COUNT}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="BASE_DIR">
					<subreportParameterExpression><![CDATA[$P{BASE_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TITLE">
					<subreportParameterExpression><![CDATA[msg("Top {0} Assets by Vulnerabilities", $P{COUNT})]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{BASE_DIR} + "/subreports/title.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="1" y="45" width="523" height="245" uuid="dfbf052f-db0b-4480-911d-88676e1019c5">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<subreportParameter name="REPORT_NAME">
					<subreportParameterExpression><![CDATA[$P{REPORT_NAME}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="COUNT">
					<subreportParameterExpression><![CDATA[$P{COUNT}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="BASE_DIR">
					<subreportParameterExpression><![CDATA[$P{BASE_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TITLE">
					<subreportParameterExpression><![CDATA[msg("Top {0} Assets by Vulnerabilities", $P{COUNT})]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{BASE_DIR} + "/subreports/charts/assets-top-vulnerabilities.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</title>
	<columnHeader>
		<band height="20" splitType="Stretch">
			<rectangle>
				<reportElement x="420" y="0" width="103" height="20" backcolor="#F0F0F0" uuid="e0ea710f-7364-421b-a8be-be6503ef78d5">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#FEFEFE"/>
				</graphicElement>
			</rectangle>
			<rectangle>
				<reportElement x="412" y="0" width="8" height="20" backcolor="#F0F0F0" uuid="a67ada75-696a-4db7-91d1-d0217b097d7e">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#F0F0F0"/>
				</graphicElement>
			</rectangle>
			<textField>
				<reportElement mode="Opaque" x="0" y="0" width="290" height="20" forecolor="#000000" backcolor="#F0F0F0" uuid="7f58630d-3892-43bd-bec9-a90414775178">
					<property name="net.sf.jasperreports.export.html.id" value="assetheader"/>
				</reportElement>
				<box topPadding="0" leftPadding="6"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Asset"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="290" y="0" width="122" height="20" forecolor="#000000" backcolor="#F0F0F0" uuid="6b2a7d9a-f725-43e0-a0fa-7d601394fd6e">
					<property name="net.sf.jasperreports.export.html.id" value="vulnheader"/>
				</reportElement>
				<box topPadding="0"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Vulnerabilities"]]></textFieldExpression>
			</textField>
			<image>
				<reportElement mode="Opaque" x="412" y="8" width="9" height="5" backcolor="#F0F0F0" uuid="79ecdbbe-2a3e-44b3-a870-fe4e3a9d6fe3"/>
				<imageExpression><![CDATA[$P{BASE_DIR} + "/images/sortdown.png"]]></imageExpression>
			</image>
			<image vAlign="Middle">
				<reportElement mode="Opaque" x="453" y="3" width="12" height="12" backcolor="#F0F0F0" uuid="98170bdd-c2cd-4bd4-a37c-d9f9a1ff4b84">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<imageExpression><![CDATA[$P{BASE_DIR} + "/images/malware.png"]]></imageExpression>
				<anchorNameExpression><![CDATA[""]]></anchorNameExpression>
				<hyperlinkTooltipExpression><![CDATA["This column lists the number of malware kits that can be used to exploit vulnerabilites detected on each asset."]]></hyperlinkTooltipExpression>
			</image>
			<image vAlign="Middle">
				<reportElement mode="Opaque" x="509" y="4" width="12" height="12" backcolor="#F0F0F0" uuid="62367f46-34ed-4468-9054-fef59960020a">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<imageExpression><![CDATA[$P{BASE_DIR} + "/images/metasploit.png"]]></imageExpression>
				<anchorNameExpression><![CDATA["This is test"]]></anchorNameExpression>
				<hyperlinkTooltipExpression><![CDATA["This column lists the number of exploits known to exist for each asset."]]></hyperlinkTooltipExpression>
			</image>
		</band>
	</columnHeader>
	<detail>
		<band height="25">
			<textField isStretchWithOverflow="true" pattern="###0" isBlankWhenNull="false">
				<reportElement key="" style="Detail" mode="Opaque" x="290" y="0" width="130" height="25" forecolor="#000000" backcolor="#FAFAFA" uuid="3aaa937e-2a99-4f9c-9984-3dab035e11d7">
					<propertyExpression name="net.sf.jasperreports.export.html.id"><![CDATA["vulncount"+$V{REPORT_COUNT}]]></propertyExpression>
				</reportElement>
				<box topPadding="0" leftPadding="6" rightPadding="6"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" markup="none">
					<font size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[NumberFormat.getIntegerInstance($P{REPORT_LOCALE}).format($F{total_vuln})]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement key="" style="Detail" x="420" y="0" width="51" height="25" uuid="65db3290-63f8-4ac1-ab0e-70bd15da841f">
					<propertyExpression name="net.sf.jasperreports.export.html.id"><![CDATA["malwarecount"+$V{REPORT_COUNT}]]></propertyExpression>
				</reportElement>
				<box topPadding="0" leftPadding="6" rightPadding="6"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[NumberFormat.getIntegerInstance($P{REPORT_LOCALE}).format($F{fa_malware_count})]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="24" width="523" height="1" forecolor="#CCCCCC" uuid="ff31cc92-1b84-4214-bc0d-f4353311c600"/>
				<graphicElement>
					<pen lineWidth="0.25" lineStyle="Solid" lineColor="#CCCCCC"/>
				</graphicElement>
			</line>
			<textField isStretchWithOverflow="true">
				<reportElement key="" style="Detail" x="471" y="0" width="52" height="25" uuid="63c37a5a-96ea-4118-9fd7-8e01c8dba599">
					<propertyExpression name="net.sf.jasperreports.export.html.id"><![CDATA["exploitcount"+$V{REPORT_COUNT}]]></propertyExpression>
				</reportElement>
				<box topPadding="0" leftPadding="6" rightPadding="6"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[NumberFormat.getIntegerInstance($P{REPORT_LOCALE}).format($F{fa_exploit_count})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement key="" style="Detail" x="28" y="0" width="262" height="25" forecolor="#000000" uuid="2f8a9cab-e903-4f5e-8918-a26896b82272">
					<propertyExpression name="net.sf.jasperreports.export.html.id"><![CDATA["assetinfo" + $V{REPORT_COUNT}]]></propertyExpression>
				</reportElement>
				<box topPadding="0"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="SansSerif" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dim_asset_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="Detail" x="0" y="0" width="28" height="25" uuid="3f05f993-7b59-4b82-84f4-7645e337be89">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box topPadding="0" leftPadding="6"/>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA["("+ $V{REPORT_COUNT} + ")"]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="22" splitType="Stretch">
			<textField evaluationTime="Auto">
				<reportElement x="471" y="0" width="52" height="20" forecolor="#333333" uuid="1bf28666-eb1f-4627-bef9-f5cd5fd7a93c"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[msg("{0} of {1}", $V{CURRENT_PAGE_NUMBER}, $V{PAGE_NUMBER})]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<noData>
		<band height="799">
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="67" y="187" width="390" height="39" forecolor="#999999" backcolor="#FFFFFF" uuid="4df5af8f-3666-4c7f-99bd-e35ef9e8d293"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["There is no data to display."]]></textFieldExpression>
			</textField>
			<rectangle>
				<reportElement x="0" y="353" width="11" height="27" backcolor="#F0F0F0" uuid="a67ada75-696a-4db7-91d1-d0217b097d7e"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#F0F0F0"/>
				</graphicElement>
			</rectangle>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="67" y="505" width="390" height="39" forecolor="#999999" backcolor="#FFFFFF" uuid="921987cf-2a95-4e63-b429-661895291ee5">
					<property name="net.sf.jasperreports.export.html.id" value="nodata"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["There is no data to display."]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="755" width="523" height="1" forecolor="#CCCCCC" uuid="74dbab2a-e9d9-4afb-a466-498e33f81685"/>
			</line>
			<textField>
				<reportElement x="471" y="760" width="52" height="20" forecolor="#333333" uuid="1bf28666-eb1f-4627-bef9-f5cd5fd7a93c"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[msg("{0} of {1}", $V{CURRENT_PAGE_NUMBER}, $V{PAGE_NUMBER})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="11" y="353" width="290" height="27" forecolor="#000000" backcolor="#F0F0F0" uuid="7f58630d-3892-43bd-bec9-a90414775178"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Assets"]]></textFieldExpression>
			</textField>
			<rectangle>
				<reportElement x="398" y="365" width="22" height="5" backcolor="#F0F0F0" uuid="a67ada75-696a-4db7-91d1-d0217b097d7e"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#F0F0F0"/>
				</graphicElement>
			</rectangle>
			<rectangle>
				<reportElement x="458" y="358" width="28" height="15" backcolor="#F0F0F0" uuid="e0ea710f-7364-421b-a8be-be6503ef78d5"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#FEFEFE"/>
				</graphicElement>
			</rectangle>
			<rectangle>
				<reportElement x="389" y="370" width="31" height="10" backcolor="#F0F0F0" uuid="a67ada75-696a-4db7-91d1-d0217b097d7e"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#F0F0F0"/>
				</graphicElement>
			</rectangle>
			<rectangle>
				<reportElement x="501" y="358" width="22" height="15" backcolor="#F0F0F0" uuid="e0ea710f-7364-421b-a8be-be6503ef78d5"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#FEFEFE"/>
				</graphicElement>
			</rectangle>
			<rectangle>
				<reportElement x="420" y="358" width="23" height="15" backcolor="#F0F0F0" uuid="e0ea710f-7364-421b-a8be-be6503ef78d5"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#FEFEFE"/>
				</graphicElement>
			</rectangle>
			<rectangle>
				<reportElement x="420" y="353" width="103" height="5" backcolor="#F0F0F0" uuid="e0ea710f-7364-421b-a8be-be6503ef78d5"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#FEFEFE"/>
				</graphicElement>
			</rectangle>
			<rectangle>
				<reportElement x="420" y="373" width="103" height="7" backcolor="#F0F0F0" uuid="e0ea710f-7364-421b-a8be-be6503ef78d5"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#FEFEFE"/>
				</graphicElement>
			</rectangle>
			<textField>
				<reportElement mode="Opaque" x="301" y="353" width="88" height="27" forecolor="#000000" backcolor="#F0F0F0" uuid="6b2a7d9a-f725-43e0-a0fa-7d601394fd6e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Vulnerabilities"]]></textFieldExpression>
			</textField>
			<image>
				<reportElement mode="Opaque" x="389" y="365" width="9" height="5" backcolor="#F0F0F0" uuid="79ecdbbe-2a3e-44b3-a870-fe4e3a9d6fe3"/>
				<imageExpression><![CDATA[$P{BASE_DIR} + "/images/sortdown.png"]]></imageExpression>
			</image>
			<image vAlign="Middle">
				<reportElement mode="Opaque" x="443" y="358" width="15" height="15" backcolor="#F0F0F0" uuid="98170bdd-c2cd-4bd4-a37c-d9f9a1ff4b84"/>
				<imageExpression><![CDATA[$P{BASE_DIR} + "/images/malware.png"]]></imageExpression>
				<anchorNameExpression><![CDATA[""]]></anchorNameExpression>
				<hyperlinkTooltipExpression><![CDATA["This column lists the number of malware kits that can be used to exploit vulnerabilites detected on each asset."]]></hyperlinkTooltipExpression>
			</image>
			<image vAlign="Middle">
				<reportElement mode="Opaque" x="486" y="358" width="15" height="15" backcolor="#F0F0F0" uuid="62367f46-34ed-4468-9054-fef59960020a"/>
				<imageExpression><![CDATA[$P{BASE_DIR} + "/images/metasploit.png"]]></imageExpression>
				<anchorNameExpression><![CDATA["This is test"]]></anchorNameExpression>
				<hyperlinkTooltipExpression><![CDATA["This column lists the number of exploits known to exist for each asset."]]></hyperlinkTooltipExpression>
			</image>
			<rectangle>
				<reportElement x="389" y="353" width="31" height="12" backcolor="#F0F0F0" uuid="a67ada75-696a-4db7-91d1-d0217b097d7e"/>
				<graphicElement>
					<pen lineWidth="0.0" lineColor="#F0F0F0"/>
				</graphicElement>
			</rectangle>
			<subreport>
				<reportElement positionType="Float" x="0" y="0" width="523" height="45" uuid="dd6a8af6-e408-451c-8709-7edbac8b989e">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<subreportParameter name="REPORT_NAME">
					<subreportParameterExpression><![CDATA[$P{REPORT_NAME}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="COUNT">
					<subreportParameterExpression><![CDATA[$P{COUNT}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="BASE_DIR">
					<subreportParameterExpression><![CDATA[$P{BASE_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TITLE">
					<subreportParameterExpression><![CDATA[msg("Top {0} Assets by Vulnerabilities", $P{COUNT})]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{BASE_DIR} + "/subreports/title.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</noData>
</jasperReport>
